the -v erbose output looks like this

```

query volkszähler for 7 day consumption data:
0 	begin 2025-10-04 14:00:00 1759579200000 	end 2025-10-05 14:00:00 1759665600000 	request duration: 0:00:04.665451 	rows: 26 : 1
1 	begin 2025-10-03 14:00:00 1759492800000 	end 2025-10-04 14:00:00 1759579200000 	request duration: 0:00:03.184913 	rows: 26 : 2
2 	begin 2025-10-02 14:00:00 1759406400000 	end 2025-10-03 14:00:00 1759492800000 	request duration: 0:00:04.177833 	rows: 26 : 3
3 	begin 2025-10-01 14:00:00 1759320000000 	end 2025-10-02 14:00:00 1759406400000 	request duration: 0:00:03.180287 	rows: 26 : 4
4 	begin 2025-09-30 14:00:00 1759233600000 	end 2025-10-01 14:00:00 1759320000000 	request duration: 0:00:03.077180 	rows: 26 : 5
5 	begin 2025-09-29 14:00:00 1759147200000 	end 2025-09-30 14:00:00 1759233600000 	request duration: 0:00:02.924161 	rows: 26 : 6
6 	begin 2025-09-28 14:00:00 1759060800000 	end 2025-09-29 14:00:00 1759147200000 	request duration: 0:00:02.965961 	rows: 26 : 7
2025-10-05 14:14 query volkszähler for energy content:
0 	begin 2025-10-05 00:00:00 1759615200000 	end 2025-10-05 14:14:27 1759666467000 	request duration: 0:00:00.612587 	rows: 30532
1 	begin 2025-10-04 00:00:00 1759528800000 	end 2025-10-05 14:14:27 1759666467000 	request duration: 0:00:01.465632 	rows: 70291
	begin 2025-10-04 08:00:22 1759557622000 	end 2025-10-05 14:14:29 1759666469000 	request duration: 0:00:02.609525 	rows: 31
minimum voltage 47.7 V, latest voltage 53.9 V, remaining battery content 6710 Wh
date time         price	 set	average	  sum
2025-10-06T18:45  43.89	 675	242	   242
2025-10-06T19:15  42.06	 675	240	   482
2025-10-06T19:30  41.30	 675	240	   722
2025-10-06T19:00  41.29	 675	240	   962
2025-10-06T19:45  40.23	 675	240	  1202
2025-10-06T20:00  39.87	 675	162	  1364
2025-10-06T17:45  39.33	 418	279	  1643
2025-10-06T18:30  38.78	 339	242	  1885
2025-10-06T09:00  37.34	 330	254	  2139
2025-10-06T22:00  37.29	 675	 87	  2226
2025-10-06T20:15  36.79	 675	162	  2388
2025-10-06T21:00  36.42	 675	119	  2507
2025-10-06T08:15  36.41	 182	182	  2689
2025-10-06T08:00  36.25	 182	182	  2871
2025-10-06T20:30  36.17	 675	162	  3033
2025-10-06T16:45  35.96	 277	277	  3310
2025-10-06T21:15  35.94	 675	119	  3429
2025-10-06T17:30  35.69	 279	279	  3708
2025-10-06T09:15  35.64	 254	254	  3962
2025-10-06T08:30  35.57	 182	182	  4144
2025-10-06T20:45  35.57	 675	162	  4306
2025-10-06T09:30  35.42	 254	254	  4560
2025-10-06T18:15  35.28	 242	242	  4802
2025-10-06T07:45  34.99	 263	263	  5065
2025-10-06T21:30  34.95	 675	119	  5184
2025-10-06T22:30  34.90	 675	 87	  5271
2025-10-06T10:00  34.84	 204	204	  5475
2025-10-06T22:15  34.83	 675	 87	  5562
2025-10-06T21:45  34.67	 675	119	  5681
2025-10-06T17:15  34.63	 279	279	  5960
2025-10-06T23:00  34.56	 675	 71	  6031
2025-10-06T08:45  34.49	 182	182	  6213
2025-10-06T16:30  34.36	 277	277	  6490
2025-10-06T22:45  34.24	 675	 87	  6577
2025-10-06T18:00  34.21	 242	242	  6819
tibber price avg: 28.71 min: 20.82 max: 43.89 spread: 23.07 (53 %) 
pvpt	 > 32.16 ¢, 94%lpt  
charge	 < 26.30 ¢, 82%lpt - 2 ¢ profit

now                  2025-10-05T14:00 20.82 ¢    0      |                    o
                     2025-10-05T14:15 20.83 ¢    0      |                    o
                     2025-10-05T14:30 20.83 ¢    0      |                    o
                     2025-10-05T14:45 20.88 ¢    0      |                    o
                     2025-10-05T15:00 20.91 ¢    0      |                    o
                     2025-10-05T15:15 20.94 ¢    0      |                    o
                     2025-10-05T15:30 20.95 ¢    0      |                    o
                     2025-10-05T15:45 20.83 ¢    0      |                    o
                     2025-10-05T16:00 21.00 ¢    0      |                     o
                     2025-10-05T16:15 21.07 ¢    0      |                     o
                     2025-10-05T16:30 21.18 ¢    0      |                     o
                     2025-10-05T16:45 21.19 ¢    0      |                     o
                     2025-10-05T17:00 20.82 ¢    0      |                    o
                     2025-10-05T17:15 21.18 ¢    0      |                     o
                     2025-10-05T17:30 21.20 ¢    0      |                     o
                     2025-10-05T17:45 21.97 ¢    0      |                     o
                     2025-10-05T18:00 21.83 ¢    0      |                     o
                     2025-10-05T18:15 22.50 ¢    0      |                      o
                     2025-10-05T18:30 23.56 ¢    0      |                       o
                     2025-10-05T18:45 24.53 ¢    0      |                        o
                     2025-10-05T19:00 23.72 ¢    0      |                       o
                     2025-10-05T19:15 24.37 ¢    0      |                        o
                     2025-10-05T19:30 26.29 ¢    0      |                          o
                     2025-10-05T19:45 27.07      0      |                           o
                     2025-10-05T20:00 25.24 ¢    0      |                         o
                     2025-10-05T20:15 24.12 ¢    0      |                        o
                     2025-10-05T20:30 22.82 ¢    0      |                      o
                     2025-10-05T20:45 22.03 ¢    0      |                      o
                     2025-10-05T21:00 22.12 ¢    0      |                      o
                     2025-10-05T21:15 21.80 ¢    0      |                     o
                     2025-10-05T21:30 21.76 ¢    0      |                     o
                     2025-10-05T21:45 21.69 ¢    0      |                     o
                     2025-10-05T22:00 21.88 ¢    0      |                     o
                     2025-10-05T22:15 21.77 ¢    0      |                     o
                     2025-10-05T22:30 21.90 ¢    0      |                     o
                     2025-10-05T22:45 21.70 ¢    0      |                     o
                     2025-10-05T23:00 21.77 ¢    0      |                     o
                     2025-10-05T23:15 21.68 ¢    0      |                     o
                     2025-10-05T23:30 21.66 ¢    0      |                     o
                     2025-10-05T23:45 21.59 ¢    0      |                     o
                     2025-10-06T00:00 24.88 ¢    0      |                        o
                     2025-10-06T00:15 24.11 ¢    0      |                        o
                     2025-10-06T00:30 23.07 ¢    0      |                       o
                     2025-10-06T00:45 22.63 ¢    0      |                      o
                     2025-10-06T01:00 22.84 ¢    0      |                      o
                     2025-10-06T01:15 22.45 ¢    0      |                      o
                     2025-10-06T01:30 22.28 ¢    0      |                      o
                     2025-10-06T01:45 21.98 ¢    0      |                     o
                     2025-10-06T02:00 22.02 ¢    0      |                      o
                     2025-10-06T02:15 22.23 ¢    0      |                      o
                     2025-10-06T02:30 22.45 ¢    0      |                      o
                     2025-10-06T02:45 22.40 ¢    0      |                      o
                     2025-10-06T03:00 22.44 ¢    0      |                      o
                     2025-10-06T03:15 22.44 ¢    0      |                      o
                     2025-10-06T03:30 22.50 ¢    0      |                      o
                     2025-10-06T03:45 22.48 ¢    0      |                      o
                     2025-10-06T04:00 22.50 ¢    0      |                      o
                     2025-10-06T04:15 23.35 ¢    0      |                       o
                     2025-10-06T04:30 23.32 ¢    0      |                       o
                     2025-10-06T04:45 23.60 ¢    0      |                       o
                     2025-10-06T05:00 22.12 ¢    0      |                      o
                     2025-10-06T05:15 22.37 ¢    0      |                      o
                     2025-10-06T05:30 23.90 ¢    0      |                       o
                     2025-10-06T05:45 27.13      0      |                           o
                     2025-10-06T06:00 23.38 ¢    0      |                       o
                     2025-10-06T06:15 30.31      0      |                              o
                     2025-10-06T06:30 30.50      0      |                              o
                     2025-10-06T06:45 33.23      0 PVpt |                                 o
                     2025-10-06T07:00 31.90      0      |                               o
                     2025-10-06T07:15 33.72      0 PVpt |                                 o
                     2025-10-06T07:30 34.15      0 PVpt |                                  o
                     2025-10-06T07:45 34.99    263 PVpt |                                  o
                     2025-10-06T08:00 36.25    182 PVpt |                                    o
                     2025-10-06T08:15 36.41    182 PVpt |                                    o
                     2025-10-06T08:30 35.57    182 PVpt |                                   o
                     2025-10-06T08:45 34.49    182 PVpt |                                  o
                     2025-10-06T09:00 37.34    330 PVpt |                                     o
                     2025-10-06T09:15 35.64    254 PVpt |                                   o
                     2025-10-06T09:30 35.42    254 PVpt |                                   o
                     2025-10-06T09:45 34.01      0 PVpt |                                  o
                     2025-10-06T10:00 34.84    204 PVpt |                                  o
                     2025-10-06T10:15 33.66      0 PVpt |                                 o
                     2025-10-06T10:30 32.52      0 PVpt |                                o
                     2025-10-06T10:45 31.59      0      |                               o
                     2025-10-06T11:00 32.92      0 PVpt |                                o
                     2025-10-06T11:15 32.23      0 PVpt |                                o
                     2025-10-06T11:30 31.29      0      |                               o
                     2025-10-06T11:45 30.83      0      |                              o
                     2025-10-06T12:00 31.02      0      |                               o
                     2025-10-06T12:15 31.51      0      |                               o
                     2025-10-06T12:30 31.44      0      |                               o
                     2025-10-06T12:45 32.37      0 PVpt |                                o
                     2025-10-06T13:00 31.19      0      |                               o
                     2025-10-06T13:15 31.67      0      |                               o
                     2025-10-06T13:30 31.17      0      |                               o
                     2025-10-06T13:45 31.00      0      |                               o
                     2025-10-06T14:00 31.04      0      |                               o
                     2025-10-06T14:15 31.85      0      |                               o
                     2025-10-06T14:30 33.21      0 PVpt |                                 o
                     2025-10-06T14:45 32.61      0 PVpt |                                o
                     2025-10-06T15:00 31.84      0      |                               o
                     2025-10-06T15:15 32.14      0      |                                o
                     2025-10-06T15:30 32.58      0 PVpt |                                o
                     2025-10-06T15:45 33.21      0 PVpt |                                 o
                     2025-10-06T16:00 31.48      0      |                               o
                     2025-10-06T16:15 32.84      0 PVpt |                                o
                     2025-10-06T16:30 34.36    277 PVpt |                                  o
                     2025-10-06T16:45 35.96    277 PVpt |                                   o
                     2025-10-06T17:00 32.37      0 PVpt |                                o
                     2025-10-06T17:15 34.63    279 PVpt |                                  o
                     2025-10-06T17:30 35.69    279 PVpt |                                   o
                     2025-10-06T17:45 39.33    418 PVpt |                                       o
                     2025-10-06T18:00 34.21    242 PVpt |                                  o
                     2025-10-06T18:15 35.28    242 PVpt |                                   o
                     2025-10-06T18:30 38.78    339 PVpt |                                      o
                     2025-10-06T18:45 43.89    675 PVpt |                                           o
                     2025-10-06T19:00 41.29    675 PVpt |                                         o
                     2025-10-06T19:15 42.06    675 PVpt |                                          o
                     2025-10-06T19:30 41.30    675 PVpt |                                         o
                     2025-10-06T19:45 40.23    675 PVpt |                                        o
                     2025-10-06T20:00 39.87    675 PVpt |                                       o
                     2025-10-06T20:15 36.79    675 PVpt |                                    o
                     2025-10-06T20:30 36.17    675 PVpt |                                    o
                     2025-10-06T20:45 35.57    675 PVpt |                                   o
                     2025-10-06T21:00 36.42    675 PVpt |                                    o
                     2025-10-06T21:15 35.94    675 PVpt |                                   o
                     2025-10-06T21:30 34.95    675 PVpt |                                  o
                     2025-10-06T21:45 34.67    675 PVpt |                                  o
                     2025-10-06T22:00 37.29    675 PVpt |                                     o
                     2025-10-06T22:15 34.83    675 PVpt |                                  o
                     2025-10-06T22:30 34.90    675 PVpt |                                  o
                     2025-10-06T22:45 34.24    675 PVpt |                                  o
                     2025-10-06T23:00 34.56    675 PVpt |                                  o
                     2025-10-06T23:15 33.69      0 PVpt |                                 o
                     2025-10-06T23:30 33.53      0 PVpt |                                 o
                     2025-10-06T23:45 33.21      0 PVpt |                                 o
disabled tasmota timer
done. 2025-10-05 14:14:31
```
At first the consumption data is taken from volkszähler's database. This gets cached hourly.
PV power, inverter input, net demand, car, charger, climate is used to calculate a 7 day average profile. (similar to [profiler.py](https://github.com/E-t0m/zeroinput/blob/main/profiler.py))

Then the energy content gets fetched: It searches for the latest empty battery voltage and calculates the remaining battery content.

The tasmota timers (and switches) are set by price thresholds.

The zeroinput timer file is calculated with descending prices as far as tibber allows the foresight.
The coming, price sorted quarter hours get summed with their 7-day-average energy usage. This is done as long there is energy in the battery.
This information is written to zeroinput's timer file, which rules the inverter.

PVpt is PV pass through, where the PV energy is directly transformed by the inverter, because of the small price gap to the next sheduled hour with input from battery.

Tib_zero_tas.py should run every 15 minutes.
I write the output to a html file which is linked (as root) from the vzlogger htdocs folder:
```
ln -s /home/vzlogger/tib_zero_tas.html /home/pi/volkszaehler.org/htdocs
```
It's found at http ://the-usual-volkszaehler-site /tib_zero_tas.html#now

The code is here: [tibber](https://github.com/E-t0m/zeroinput/tree/main/tibber)
